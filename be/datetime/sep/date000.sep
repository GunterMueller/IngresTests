/*

  Copyright (c) 2007 Ingres Corporation

  Test Name     : date000_93.sep
  Suite         : be!datetime
  Focus         : Ingres 2006 Release 2 New Feature:
                : ANSI DATE Datatype 

  Databases     : SEPPARAMDB (datetimedb)
  Tables        : dt000_t1,dt000_t2
  Filled Files  : 
  Copied Files  : 
  Output Files  :
  Prerequisites : date_type_alias = ingresdate
  Run as user   : testenv
  Summary       : Basic functionality test: 
                :   * Data inserted and retrieved correctly
                :   * Simple predicates
                :   * ORDER BY

  Exp. DIFFs    : None 
  History       : 18-Dec-2008 (sarjo01) 9.3 specific test created from
                :             date000.sep.

*/

? sql -s SEPPARAMDB 
<<

>>
* drop dt000_t1, dt000_t2\g
<<
~
>>
* create table dt000_t2 (dt000_t2_c1 ansidate,-
  dt000_t2_c2 ingresdate, dt000_t2_c3 date)\g
<<

>>
/*
** Verify internal datatypes and alias
*/
* select attname, attfrmt from iiattribute where attname like 'dt000_t2%'-
  order by 1\g 
<<

+--------------------------------+------+
|attname                         |attfrm|
+--------------------------------+------+
|dt000_t2_c1                     |    -4|
|dt000_t2_c2                     |    -3|
|dt000_t2_c3                     |    -3|
+--------------------------------+------+
(3 rows)
>>
* create table dt000_t1 (dt000_t1_c1 ansidate, dt000_t1_c2 int)\g
<<

>>
* insert into dt000_t1 values ('07/04/2006', 1)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('04-jul-2006', 1)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('07-04-2006', 1)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('2006-13-04', 1)\g 
<<
E_US10D0 13 is not a valid month for a date/time column.
    (Wed Feb  7 06:48:17 2007)

>>
* insert into dt000_t1 values ('2006-07-32', 1)\g 
<<
E_US10D1 32 is not a valid day for a date/time column.
    (Wed Feb  7 06:49:32 2007)

>>
* insert into dt000_t1 values ('2006-07-00', 1)\g 
<<
E_US10D1 0 is not a valid day for a date/time column.
    (Wed Feb  7 06:50:22 2007)

>>
* insert into dt000_t1 values ('2006-02-29', 1)\g 
<<
E_US10D1 29 is not a valid day for a date/time column.
    (Wed Feb  7 06:51:04 2007)

>>
* insert into dt000_t1 values ('2006-02-30', 1)\g 
<<
E_US10D1 30 is not a valid day for a date/time column.
    (Wed Feb  7 06:51:43 2007)

>>
* insert into dt000_t1 values ('6-07-04', 1)\g 
<<
E_US10E5 '6-07-04' is an invalid format or value for ANSI date. Please
    enter a valid date in yyyy-mm-dd format.
    (Thu Dec 18 16:57:40 2008)

>>
* insert into dt000_t1 values ('06-07-04', 1)\g 
<<
E_US10E5 '06-07-04' is an invalid format or value for ANSI date. Please
    enter a valid date in yyyy-mm-dd format.
    (Thu Dec 18 16:57:40 2008)

>>
* insert into dt000_t1 values ('0000-01-01', 1)\g 
<<
E_US10CF 0 is not a valid year for a date/time column.
    (Fri Feb  9 11:13:12 2007)

>>
* insert into dt000_t1 values ('2006-07-04', 1)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('2006-7-5', 2)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('0006-07-04', 3)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('2004-02-29', 4)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('9999-12-31', 5)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('2006-11-30', 6)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('0066-07-04', 7)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('0666-07-04', 8)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('2666-07-04', 9)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('2000-04-30', 10)\g 
<<
(1 row)
>>
* insert into dt000_t1 values ('0001-01-01', 11)\g 
<<
(1 row)
>>
* select * from dt000_t1 order by 1\g
<<

+----------+-------------+
|dt000_t1_c|dt000_t1_c2  |
+----------+-------------+
|0001-01-01|           11|
|0006-07-04|            3|
|0066-07-04|            7|
|0666-07-04|            8|
|2000-04-30|           10|
|2004-02-29|            4|
|2006-07-04|            1|
|2006-07-04|            1|
|2006-07-04|            1|
|2006-07-04|            1|
|2006-07-05|            2|
|2006-11-30|            6|
|2666-07-04|            9|
|9999-12-31|            5|
+----------+-------------+
(14 rows)
>>
* select * from dt000_t1 order by 1 desc\g
<<

+----------+-------------+
|dt000_t1_c|dt000_t1_c2  |
+----------+-------------+
|9999-12-31|            5|
|2666-07-04|            9|
|2006-11-30|            6|
|2006-07-05|            2|
|2006-07-04|            1|
|2006-07-04|            1|
|2006-07-04|            1|
|2006-07-04|            1|
|2004-02-29|            4|
|2000-04-30|           10|
|0666-07-04|            8|
|0066-07-04|            7|
|0006-07-04|            3|
|0001-01-01|           11|
+----------+-------------+
(14 rows)
>>
* select min(dt000_t1_c1), max(dt000_t1_c1) from dt000_t1\g
<<

+----------+----------+
|col1      |col2      |
+----------+----------+
|0001-01-01|9999-12-31|
+----------+----------+
(1 row)
>>
* select * from dt000_t1 where dt000_t1_c1 = '2006-07-04'\g
<<

+----------+-------------+
|dt000_t1_c|dt000_t1_c2  |
+----------+-------------+
|2006-07-04|            1|
|2006-07-04|            1|
|2006-07-04|            1|
|2006-07-04|            1|
+----------+-------------+
(4 rows)
>>
* select * from dt000_t1 where dt000_t1_c1 <> '2006-07-04' order by 1\g
<<

+----------+-------------+
|dt000_t1_c|dt000_t1_c2  |
+----------+-------------+
|0001-01-01|           11|
|0006-07-04|            3|
|0066-07-04|            7|
|0666-07-04|            8|
|2000-04-30|           10|
|2004-02-29|            4|
|2006-07-05|            2|
|2006-11-30|            6|
|2666-07-04|            9|
|9999-12-31|            5|
+----------+-------------+
(10 rows)
>>
* select * from dt000_t1 where dt000_t1_c1 < '2004-03-01' order by 1\g
<<

+----------+-------------+
|dt000_t1_c|dt000_t1_c2  |
+----------+-------------+
|0001-01-01|           11|
|0006-07-04|            3|
|0066-07-04|            7|
|0666-07-04|            8|
|2000-04-30|           10|
|2004-02-29|            4|
+----------+-------------+
(6 rows)
>>
* select * from dt000_t1 where dt000_t1_c1 > '2000-04-30' order by 1\g
<<

+----------+-------------+
|dt000_t1_c|dt000_t1_c2  |
+----------+-------------+
|2004-02-29|            4|
|2006-07-04|            1|
|2006-07-04|            1|
|2006-07-04|            1|
|2006-07-04|            1|
|2006-07-05|            2|
|2006-11-30|            6|
|2666-07-04|            9|
|9999-12-31|            5|
+----------+-------------+
(9 rows)
>>
* \q
<<
~
>>
