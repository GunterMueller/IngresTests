/*
  Copyright (c) 2008 Ingres Corporation

  Test Name     : dtu34.sep
  Suite         : be!datatypes
  Focus         : Ingres regression test
                : Test for bug 118903 - Incorrect handling of unicode
                : upper case sigma in final sigma position.
                :
                : This sep test uses the '0041' byte swap check to 
                : normalize output between swap/no swap platforms
                :
  Databases     : SEPPARAMDB3 - Requires unicode database
  Tables        : dtu34_t1
  Filled Files  : 
  Copied Files  :
  Output Files  :
  Prerequisites : None
  Run as user   : testenv 
  Summary       : Verifies fix for bug 118903
                :
                :
  Exp. DIFFs    : None
                :
  History       : 07-Aug-2008 (wanfr01) Created.
                : 08-Aug-2008 (sarjo01) Formalized for piccolo.
                : 22-Oct-2008 (wanfr01) Test does not currently run on VMS
*/
.if !(VMS)
? sql -s SEPPARAMDB3
<< 

>> 

* drop dtu34_t1 \g
<<
~
>>
* create table dtu34_t1(a nvarchar(10)) \g
<<
>>
* insert into dtu34_t1 values (u&'AB\0027\03A3') \g
<<
(1 row)
>>
* select case substring(hex(u&'\0041') from 3 for 2) when '00'   -
then substring(hex(lower(a)) from 3 for 2) + -
substring(hex(lower(a)) from 1 for 2) + -
substring(hex(lower(a)) from 7 for 2) + -
substring(hex(lower(a)) from 5 for 2) + -
substring(hex(lower(a)) from 11 for 2) + -
substring(hex(lower(a)) from 9 for 2) + -
substring(hex(lower(a)) from 15 for 2) + -
substring(hex(lower(a)) from 13 for 2) -
else hex(lower(a)) end from dtu34_t1 \g
<<

+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

|col1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

|00610062002703C2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

(1 row)
>>
* delete from dtu34_t1\g
<<
(1 row)
>>
* insert into dtu34_t1 values (u&'AB\0027\03A3\00adAB') \g
<<
(1 row)
>>
* select case substring(hex(u&'\0041') from 3 for 2) when '00'   -
then -
substring(hex(lower(a)) from 3 for 2) + -
substring(hex(lower(a)) from 1 for 2) + -
substring(hex(lower(a)) from 7 for 2) + -
substring(hex(lower(a)) from 5 for 2) + -
substring(hex(lower(a)) from 11 for 2) + -
substring(hex(lower(a)) from 9 for 2) + -
substring(hex(lower(a)) from 15 for 2) + -
substring(hex(lower(a)) from 13 for 2) + -
substring(hex(lower(a)) from 19 for 2) + -
substring(hex(lower(a)) from 17 for 2) + -
substring(hex(lower(a)) from 23 for 2) + -
substring(hex(lower(a)) from 21 for 2) + -
substring(hex(lower(a)) from 27 for 2) + -
substring(hex(lower(a)) from 25 for 2)  -
 else hex(lower(a)) end from dtu34_t1 \g
<<

+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

|col1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

|00610062002703C300AD00610062                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

(1 row)
>>
* delete from dtu34_t1\g
<<
(1 row)
>>
* insert into dtu34_t1 values (u&'a\03A3') \g
<<
(1 row)
>>
* select case substring(hex(u&'\0041') from 3 for 2) when '00'   -
then substring(hex(lower(a)) from 3 for 2) + -
substring(hex(lower(a)) from 1 for 2) + -
substring(hex(lower(a)) from 7 for 2) + -
substring(hex(lower(a)) from 5 for 2)  -
else hex(lower(a)) end from dtu34_t1 \g
<<

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

|col1                                                                                                                                                                                                                                                                                                                                                            |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

|006103C2                                                                                                                                                                                                                                                                                                                                                        |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

(1 row)
>>
* delete from dtu34_t1\g
<<
(1 row)
>>
* insert into dtu34_t1 values (u&'a\03A3b') \g
<<
(1 row)
>>
* select case substring(hex(u&'\0041') from 3 for 2) when '00'   -
then -
substring(hex(lower(a)) from 3 for 2) + -
substring(hex(lower(a)) from 1 for 2) + -
substring(hex(lower(a)) from 7 for 2) + -
substring(hex(lower(a)) from 5 for 2) + -
substring(hex(lower(a)) from 11 for 2) + -
substring(hex(lower(a)) from 9 for 2) -
else hex(lower(a)) end from dtu34_t1 \g
<<

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

|col1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

|006103C30062                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

(1 row)
>>
* \q
<<
>>
.endif
