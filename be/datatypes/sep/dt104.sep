/*
  Copyright (c) 2010 Ingres Corporation

  Test Name     : dt104.sep
  Suite         : be!datatypes
  Focus         : Test for Ingres 10.0 New Feature: BOOLEAN Datatype 
                : basic table join test cases.
                :
  Databases     : SEPPARAMDB
  Tables        : dt104_tbl1, dt104_tbl2
  Filled Files  : 
  Copied Files  :
  Output Files  :
  Prerequisites : None
  Run as user   : testenv
  Summary       : Tests basic functionality in Terminal Monitor joining tables
		  on BOOLEAN columns:
		  1)  Full Join.
		  2)  Simple Join.
		  3)  Join and WHERE column.
		  4)  Join and WHERE NOT col.
		  5)  Join ON not equal.
		  6)  Join WHERE equals.
		  7)  Join WHERE equals AND column.
		  8)  Select cartesian product of two tables having BOOLEAN col.
		  9)  Join WHERE BOOLEAN > BOOLEAN.
		  10) Join WHERE BOOLEAN >= BOOLEAN.
		  11) Join WHERE BOOLEAN < BOOLEAN.
		  12) Join WHERE BOOLEAN < BOOLEAN with t2.c2 < t1.c2.
		  13) Join WHERE BOOLEAN <= BOOLEAN.
		  14) Join WHERE BOOLEAN != BOOLEAN.
		  15) Left Join on two tables with BOOLEAN columns.
		  16) Right Join on two tables with BOOLEAN columns.
		  17) Outer Join on two tables with BOOLEAN columns FROM clause.
		  18) Same Join as above with USING clause.

  Known Issues	: None
                :
  History       : 02-Feb-2010 (vande02) Created.
		: 22-Feb-2010 (vande02) Added outer join and using clause join.
*/
? sql -s SEPPARAMDB
<<
>>
* drop table dt104_tbl1, dt104_tbl2\g
<<
~
>>
* create table dt104_tbl1 (c1 integer, c2 boolean)\g
<<
>>
* create table dt104_tbl2 (c1 integer, c2 boolean)\g
<<
>>
* insert into dt104_tbl1 values (1, true)\g
<<
(1 row)
>>
* insert into dt104_tbl1 values (2, false)\g
<<
(1 row)
>>
* insert into dt104_tbl1 values (3, true)\g
<<
(1 row)
>>
* insert into dt104_tbl2 values (4, 'true')\g
<<
(1 row)
>>
* insert into dt104_tbl2 values (5, 'false')\g
<<
(1 row)
>>
* insert into dt104_tbl2 values (6, null)\g
<<
(1 row)
>>
* select * from dt104_tbl1 order by 1\g
<<
+-------------+-----+
|c1           |c2   |
+-------------+-----+
|            1|TRUE |
|            2|FALSE|
|            3|TRUE |
+-------------+-----+
(3 rows)
>>
* select * from dt104_tbl2 order by 1\g
<<
+-------------+-----+
|c1           |c2   |
+-------------+-----+
|            4|TRUE |
|            5|FALSE|
|            6|     |
+-------------+-----+
(3 rows)
>>
/*
1) Full Join two tables on BOOLEAN columns with JOIN
*/
* select * from dt104_tbl1 t1 full join dt104_tbl2 t2 on t1.c1=t2.c1\g
<<

+-------------+-----+-------------+-----+
|c1           |c2   |c1           |c2   |
+-------------+-----+-------------+-----+
|             |     |            4|TRUE |
|             |     |            5|FALSE|
|             |     |            6|     |
|            1|TRUE |             |     |
|            2|FALSE|             |     |
|            3|TRUE |             |     |
+-------------+-----+-------------+-----+
(6 rows)
>>
/*
2) Join two tables on BOOLEAN columns with JOIN
*/
* select t1.c1 from dt104_tbl1 t1 join dt104_tbl2 t2 on t1.c2 = t2.c2\g
<<
+-------------+
|c1           |
+-------------+
|            1|
|            2|
|            3|
+-------------+
(3 rows)
>>
/*
3) Join two tables on BOOLEAN columns with JOIN and WHERE column.
*/
* select t1.c1 from dt104_tbl1 t1 join dt104_tbl2 t2 on t1.c2 = t2.c2-
  where t1.c2 IS TRUE\g
<<
+-------------+
|c1           |
+-------------+
|            1|
|            3|
+-------------+
(2 rows)
>>
/*
4) Join two tables on BOOLEAN columns with JOIN and WHERE NOT column.
*/
* select t1.c1 from dt104_tbl1 t1 join dt104_tbl2 t2 on t1.c2 = t2.c2-
  where not t2.c2 IS TRUE\g
<<
+-------------+
|c1           |
+-------------+
|            2|
+-------------+
(1 row)
>>
/*
5) Join two tables on BOOLEAN columns with JOIN syntax ON not equal.
*/
* select t1.c1 from dt104_tbl1 t1 join dt104_tbl2 t2 on t1.c2 != t2.c2\g
<<
+-------------+
|c1           |
+-------------+
|            1|
|            2|
|            3|
+-------------+
(3 rows)
>>
/*
6) Join two tables on BOOLEAN columns with WHERE equals.
*/
* select t1.c1 from dt104_tbl1 t1, dt104_tbl2 t2 where t1.c2 = t2.c2\g
<<
+-------------+
|c1           |
+-------------+
|            1|
|            2|
|            3|
+-------------+
(3 rows)
>>
/*
7) Join two tables on BOOLEAN columns with WHERE equals AND column.
*/
* select t1.c1 from dt104_tbl1 t1, dt104_tbl2 t2 where-
  t1.c2 = t2.c2 AND t1.c2 IS TRUE\g
<<
+-------------+
|c1           |
+-------------+
|            1|
|            3|
+-------------+
(2 rows)
>>
/*
8) Select the cartesian product of two tables having BOOLEAN columns.
*/
* select t1.c1 from dt104_tbl1 t1, dt104_tbl2 t2\g
<<
+-------------+
|c1           |
+-------------+
|            1|
|            1|
|            1|
|            2|
|            2|
|            2|
|            3|
|            3|
|            3|
+-------------+
(9 rows)
>>
/*
9) Join two tables on BOOLEAN columns with WHERE BOOLEAN > BOOLEAN.
*/
* select t1.c1 from dt104_tbl1 t1, dt104_tbl2 t2 where t1.c2 > t2.c2\g
<<
+-------------+
|c1           |
+-------------+
|            1|
|            3|
+-------------+
(2 rows)
>>
/*
10) Join two tables on BOOLEAN columns with WHERE BOOLEAN >= BOOLEAN.
*/
* select t1.c1 from dt104_tbl1 t1, dt104_tbl2 t2 where t1.c2 >= t2.c2\g
<<

+-------------+
|c1           |
+-------------+
|            1|
|            1|
|            2|
|            3|
|            3|
+-------------+
(5 rows)
>>
/*
11) Join two tables on BOOLEAN columns with WHERE BOOLEAN < BOOLEAN.
*/
* select t1.c1 from dt104_tbl1 t1, dt104_tbl2 t2 where t1.c2 < t2.c2\g
<<
+-------------+
|c1           |
+-------------+
|            2|
+-------------+
(1 row)
>>
/*
12) Join two tables on BOOLEAN columns with WHERE BOOLEAN < BOOLEAN
but comparing t2.c2 < t1.c2.
*/
* select t1.c1 from dt104_tbl1 t1, dt104_tbl2 t2 where t2.c2 < t1.c2\g
<<
+-------------+
|c1           |
+-------------+
|            1|
|            3|
+-------------+
(2 rows)
>>
/*
13) Join two tables on BOOLEAN columns with WHERE BOOLEAN <= BOOLEAN
*/
* select t1.c1 from dt104_tbl1 t1, dt104_tbl2 t2 where t1.c2 <= t2.c2\g
<<
+-------------+
|c1           |
+-------------+
|            1|
|            2|
|            2|
|            3|
+-------------+
(4 rows)
>>
/*
14) Join two tables on BOOLEAN columns with WHERE BOOLEAN != BOOLEAN
*/
* select t1.c1 from dt104_tbl1 t1, dt104_tbl2 t2 where t1.c2 != t2.c2\g
<<
+-------------+
|c1           |
+-------------+
|            1|
|            2|
|            3|
+-------------+
(3 rows)
>>
/*
15) Left Join on two tables with BOOLEAN columns.
*/
* select * from dt104_tbl1 t1 left join dt104_tbl2 t2 on t1.c1=t2.c1\g
<<
+-------------+-----+-------------+-----+
|c1           |c2   |c1           |c2   |
+-------------+-----+-------------+-----+
|            1|TRUE |             |     |
|            2|FALSE|             |     |
|            3|TRUE |             |     |
+-------------+-----+-------------+-----+
(3 rows)
>>
/*
16) Right Join on two tables with BOOLEAN columns.
*/
* select * from dt104_tbl1 t1 right join dt104_tbl2 t2 on t1.c1 = t2.c1\g
<<
+-------------+-----+-------------+-----+
|c1           |c2   |c1           |c2   |
+-------------+-----+-------------+-----+
|             |     |            4|TRUE |
|             |     |            5|FALSE|
|             |     |            6|     |
+-------------+-----+-------------+-----+
(3 rows)
>>
/*
17) Outer Join on two tables with BOOLEAN columns in the FROM clause.
*/
* select t1.c1, t2.c1 from (dt104_tbl1 t1 left join dt104_tbl2 t2 on-
  t1.c2 = t2.c2)\g
<<

+-------------+-------------+
|c1           |c1           |
+-------------+-------------+
|            3|            4|
|            1|            4|
|            2|            5|
+-------------+-------------+
(3 rows)
>>
/*
18) Same Join as above with the USING clause which expects the same result.
*/
* select t1.c1, t2.c1 from (dt104_tbl1 t1 left join dt104_tbl2 t2 using (c2))\g
<<

+-------------+-------------+
|c1           |c1           |
+-------------+-------------+
|            3|            4|
|            1|            4|
|            2|            5|
+-------------+-------------+
(3 rows)
>>
* \q
<<
>>
