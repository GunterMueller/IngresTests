/*
  Copyright (c) 2008 Ingres Corporation

  Test Name     : dtu27.sep
  Suite         : be!datatypes
  Focus         : Ingres 2006+ regression test
                : Bug 119085 - optimizedb SEGV on unicode database
                :
                : Bug 120754 - optimizedb fails with E_OP091A; status=70154, 
                : size=0.
                :
  Databases     : SEPPARAMDB3 (unicode database required)
  Tables        : dtu27_t1
  Filled Files  : 
  Copied Files  : dtu27_t1.dat
  Output Files  :
  Prerequisites : None
  Run as user   : testenv
  Summary       : Verifies fix for bug 119085
                :
  Exp. DIFFs    : None
                :
  History       : 19-Jun-2008 (wanfr01) Created.
                : 19-Jun-2008 (sarjo01) Made ready for piccolo. 
                : 22-Oct-2008 (wanfr01) Test does not currently run on VMS
*/
.if !(VMS)
? fill dtu27_t1.dat
!!
!!
? cp @file(ing_tst,be,datatypes,data,dtu27_t1.dat) dtu27_t1.dat
<<
>>
? sql -s SEPPARAMDB3
<< 

>> 
* drop table dtu27_t1\g
<<
~
>>
* create table dtu27_t1( -
        id integer not null, -
        persid nvarchar(30) collate unicode_case_insensitive, -
        ref_num nvarchar(30) not null collate unicode_case_insensitive, -
        summary nvarchar(240) collate unicode_case_insensitive, -
        description nvarchar(4000) collate unicode_case_insensitive, -
        status nvarchar(12) collate unicode_case_insensitive, -
        active_flag integer not null, -
        open_date integer, -
        time_spent_sum integer, -
        last_mod_dt integer, -
        last_mod_by byte(16), -
        close_date integer, -
        resolve_date integer, -
        rootcause integer, -
        log_agent byte(16) not null, -
        assignee byte(16), -
        group_id byte(16), -
        customer byte(16) not null, -
        charge_back_id nvarchar(12) collate unicode_case_insensitive, -
        affected_rc byte(16), -
        support_lev nvarchar(30) collate unicode_case_insensitive, -
        category nvarchar(30) collate unicode_case_insensitive, -
        solution nvarchar(30) collate unicode_case_insensitive, -
        impact integer, -
        priority integer not null, -
        urgency integer, -
        severity integer, -
        extern_ref nvarchar(30) collate unicode_case_insensitive, -
        last_act_id nvarchar(12) collate unicode_case_insensitive, -
        cr_tticket integer, -
        parent nvarchar(30) collate unicode_case_insensitive, -
        template_name nvarchar(30) collate unicode_case_insensitive, -
        sla_violation integer, -
        predicted_sla_viol integer, -
        macro_predict_viol integer, -
        created_via integer, -
        call_back_date integer, -
        call_back_flag integer, -
        event_token nvarchar(30) collate unicode_case_insensitive, -
        sched_token nvarchar(128) collate unicode_case_insensitive, -
        type nvarchar(10) collate unicode_case_insensitive, -
        string1 nvarchar(40) collate unicode_case_insensitive, -
        string2 nvarchar(40) collate unicode_case_insensitive, -
        string3 nvarchar(40) collate unicode_case_insensitive, -
        string4 nvarchar(40) collate unicode_case_insensitive, -
        string5 nvarchar(40) collate unicode_case_insensitive, -
        string6 nvarchar(40) collate unicode_case_insensitive, -
        problem nvarchar(30) collate unicode_case_insensitive, -
        incident_priority integer, -
        change integer, -
        zmaint_refno nvarchar(32) -
) -
with duplicates, -
nojournaling, -
        page_size = 32768, -
security_audit=(table,norow) \g
<<
>>
* copy dtu27_t1( -
        id= c0tab, -
        persid= nvarchar(0)tab with null(']^NULL^['), -
        ref_num= nvarchar(0)tab, -
        summary= nvarchar(0)tab with null(']^NULL^['), -
        description= nvarchar(0)tab with null(']^NULL^['), -
        status= nvarchar(0)tab with null(']^NULL^['), -
        active_flag= c0tab, -
        open_date= c0tab with null(']^NULL^['), -
        time_spent_sum= c0tab with null(']^NULL^['), -
        last_mod_dt= c0tab with null(']^NULL^['), -
        last_mod_by= varchar(0)tab with null(']^NULL^['), -
        close_date= c0tab with null(']^NULL^['), -
        resolve_date= c0tab with null(']^NULL^['), -
        rootcause= c0tab with null(']^NULL^['), -
        log_agent= varchar(0)tab, -
        assignee= varchar(0)tab with null(']^NULL^['), -
        group_id= varchar(0)tab with null(']^NULL^['), -
        customer= varchar(0)tab, -
        charge_back_id= nvarchar(0)tab with null(']^NULL^['), -
        affected_rc= varchar(0)tab with null(']^NULL^['), -
        support_lev= nvarchar(0)tab with null(']^NULL^['), -
        category= nvarchar(0)tab with null(']^NULL^['), -
        solution= nvarchar(0)tab with null(']^NULL^['), -
        impact= c0tab with null(']^NULL^['), -
        priority= c0tab, -
        urgency= c0tab with null(']^NULL^['), -
        severity= c0tab with null(']^NULL^['), -
        extern_ref= nvarchar(0)tab with null(']^NULL^['), -
        last_act_id= nvarchar(0)tab with null(']^NULL^['), -
        cr_tticket= c0tab with null(']^NULL^['), -
        parent= nvarchar(0)tab with null(']^NULL^['), -
        template_name= nvarchar(0)tab with null(']^NULL^['), -
        sla_violation= c0tab with null(']^NULL^['), -
        predicted_sla_viol= c0tab with null(']^NULL^['), -
        macro_predict_viol= c0tab with null(']^NULL^['), -
        created_via= c0tab with null(']^NULL^['), -
        call_back_date= c0tab with null(']^NULL^['), -
        call_back_flag= c0tab with null(']^NULL^['), -
        event_token= nvarchar(0)tab with null(']^NULL^['), -
        sched_token= nvarchar(0)tab with null(']^NULL^['), -
        type= nvarchar(0)tab with null(']^NULL^['), -
        string1= nvarchar(0)tab with null(']^NULL^['), -
        string2= nvarchar(0)tab with null(']^NULL^['), -
        string3= nvarchar(0)tab with null(']^NULL^['), -
        string4= nvarchar(0)tab with null(']^NULL^['), -
        string5= nvarchar(0)tab with null(']^NULL^['), -
        string6= nvarchar(0)tab with null(']^NULL^['), -
        problem= nvarchar(0)tab with null(']^NULL^['), -
        incident_priority= c0tab with null(']^NULL^['), -
        change= c0tab with null(']^NULL^['), -
        zmaint_refno= nvarchar(0)nl with null(']^NULL^['), -
        nl= d0nl) -
from 'dtu27_t1.dat' \g
<<
(94 rows)
>>
* \q
<<

>>
/*
 * optimizedb will segv if bug 119085 is not fixed
 */
? optimizedb SEPPARAMDB3 -rdtu27_t1
<<

>>
.endif
