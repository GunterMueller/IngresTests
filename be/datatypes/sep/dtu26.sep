/*
  Copyright (c) 2008 Ingres Corporation

  Test Name     : dtu26.sep
  Suite         : be!datatypes
  Focus         : Ingres 2006r2 regression test
                : Test for bug 118344 - Errors or wrong results using
                : shift, left, and right for integer8 
                :
                : Test for bug 120556 - segv in IIPERMITTYPE
                :
  Databases     : SEPPARAMDB3 (unidb) 
  Tables        : dtu26_t1
  Filled Files  : 
  Copied Files  :
  Output Files  :
  Prerequisites : None
  Run as user   : testenv
  Summary       : Veries fix for bug 118334
                :
  Exp. DIFFs    : None
                :
  History       : 10-Jun-2008 (wanfr01) Created.
                : 11-Jun-2008 (sarjo01) Formalized for piccolo. 
                : 02-Jul-2008 (sarjo01) Replaced intextract() arg with hex
                :             string to avoid diffs due to byte-swapping. 
                :             Commented out queries using iipermittype()
                :             pending resolution of SD 129464
                : 29-Aug-2008 (wanfr01) Added bug to comments
                : 22-Oct-2008 (wanfr01) Test does not currently run on VMS
*/
.if !(VMS)
? sql -s SEPPARAMDB3
<<

>>
* select left(varchar('abcde'),int8(2))\g
<<

+------+
|col1  |
+------+
|ab    |
+------+
(1 row)
>>
* select right(varchar('abcde'),int8(2))\g
<<

+------+
|col1  |
+------+
|de    |
+------+
(1 row)
>>
* select substring(varchar('abcde') from int8(2))\g
<<

+------+
|col1  |
+------+
|bcde  |
+------+
(1 row)
>>
* select substring(varchar('abcde') from int8(2) for int8(2))\g
<<

+------+
|col1  |
+------+
|bc    |
+------+
(1 row)
>>
* select shift (varchar('abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrst-
uvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklm-
nopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdef-
ghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvw-
xyzabcdefghijklmnopqrstuvwxyz'), int8(256))\g
<<

+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|col1                                                                                                                                                                                                                                                                |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                                                                                abcd|
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)
>>
* select charextract('abcde', int8(4))\g
<<

+------+
|col1  |
+------+
|d     |
+------+
(1 row)
>>
* select iistructure(int8(3))\g
<<

+----------------+
|col1            |
+----------------+
|HEAP            |
+----------------+
(1 row)
>>
* select gmt_timestamp(int8(1))\g
<<

+-------------------------+
|col1                     |
+-------------------------+
|1970_01_01 00:00:01 GMT  |
+-------------------------+
(1 row)
>>
* select _date(int8(1))\g
<<

+---------+
|col1     |
+---------+
|31-dec-69|
+---------+
(1 row)
>>
* select _date4(int8(1))\g
<<

+-----------+
|col1       |
+-----------+
|31-dec-1969|
+-----------+
(1 row)
>>
* select _time(int8(60))\g
<<

+------+
|col1  |
+------+
|19:01 |
+------+
(1 row)
>>
* select ii_dv_desc(int8(1))\g
<<

+--------------------------------------------------------------+
|col1                                                          |
+--------------------------------------------------------------+
|integer8                                                      |
+--------------------------------------------------------------+
(1 row)
>>
* select ii_ext_length(int8(30),8)\g
<<

+-------------+
|col1         |
+-------------+
|            8|
+-------------+
(1 row)
>>
* select ii_ext_length(int8(30),int8(8))\g
<<

+-------------+
|col1         |
+-------------+
|            8|
+-------------+
(1 row)
>>
* select ii_ext_type(int8(30),int8(4))\g
<<

+-------------+
|col1         |
+-------------+
|           30|
+-------------+
(1 row)
>>
* select ii_iftrue(int8(1),30)\g
<<

+------+
|col1  |
+------+
|    30|
+------+
(1 row)
>>
* select ifnull(int8(NULL),20)\g
<<

+----------------------+
|col1                  |
+----------------------+
|                    20|
+----------------------+
(1 row)
>>
* select ifnull(int8(34184918141481348),20)\g
<<

+----------------------+
|col1                  |
+----------------------+
|     34184918141481348|
+----------------------+
(1 row)
>>
* select intextract(X'4142434455', int8(3))\g
<<

+------+
|col1  |
+------+
|    67|
+------+
(1 row)
>>
/*
* select iipermittype(int8(3), int4(0))\g
<<

+----------------------------------------------------------------+
|col1                                                            |
+----------------------------------------------------------------+
|SELECT                                                          |
+----------------------------------------------------------------+
(1 row)
>>
* select iipermittype(3, int8(0))\g
<<

+----------------------------------------------------------------+
|col1                                                            |
+----------------------------------------------------------------+
|SELECT                                                          |
+----------------------------------------------------------------+
(1 row)
>>
*/
* select ii_tabid_di(int8(27),int8(36))\g
<<

+--------+
|col1    |
+--------+
|aaaaaace|
+--------+
(1 row)
>>
* select iitypename(int8(30))\g
<<

+--------------------------------+
|col1                            |
+--------------------------------+
|integer                         |
+--------------------------------+
(1 row)
>>
* select iiuserlen(int8(30),int4(65536))\g
<<

+-------------+
|col1         |
+-------------+
|            1|
+-------------+
(1 row)
>>
* select iiuserlen(int4(30),int8(65536))\g
<<

+-------------+
|col1         |
+-------------+
|            1|
+-------------+
(1 row)
>>
* select ii_row_count(int8(256),0)\g
<<

+-------------+
|col1         |
+-------------+
|          257|
+-------------+
(1 row)
>>
* drop table dtu26_t1\g
<<
~
>>
* commit\g
<<
>>
* create table dtu26_t1 (mydtu26_t1 long varchar)\g
<<
>>
* commit\g
<<
>>
* insert into dtu26_t1 values ('abcdefghijklmnopqrstuvwxyz')\g
<<
(1 row)
>>
* commit\g
<<
>>
* select left(mydtu26_t1, int8(257)) from dtu26_t1\g
<<

+--------------------------------+
|col1                            |
+--------------------------------+
|abcdefghijklmnopqrstuvwxyz      |
+--------------------------------+
(1 row)
>>
* select right (mydtu26_t1, int8(257)) from dtu26_t1\g
<<

+--------------------------------+
|col1                            |
+--------------------------------+
|abcdefghijklmnopqrstuvwxyz      |
+--------------------------------+
(1 row)
>>
* select substr(mydtu26_t1, int8(257)) from dtu26_t1\g
<<

+--------------------------------+
|col1                            |
+--------------------------------+
|                                |
+--------------------------------+
(1 row)
>>
* select charextract(nvarchar('string'),int8(3))\g
<<

+------+
|col1  |
+------+
|r     |
+------+
(1 row)
>>
* select left (nvarchar('string'),int8(3))\g
<<

+--------------------------------------------------------------+
|col1                                                          |
+--------------------------------------------------------------+
|str                                                           |
+--------------------------------------------------------------+
(1 row)
>>
* select left (nvarchar('string'),int8(256))\g
<<

+--------------------------------------------------------------+
|col1                                                          |
+--------------------------------------------------------------+
|string                                                        |
+--------------------------------------------------------------+
(1 row)
>>
* select left (nvarchar('string'),int8(9))\g
<<

+--------------------------------------------------------------+
|col1                                                          |
+--------------------------------------------------------------+
|string                                                        |
+--------------------------------------------------------------+
(1 row)
>>
* select right (nvarchar('string'), int8(256))\g
<<

+--------------------------------------------------------------+
|col1                                                          |
+--------------------------------------------------------------+
|string                                                        |
+--------------------------------------------------------------+
(1 row)
>>
* select right (nvarchar('string'), int8(9))\g
<<

+--------------------------------------------------------------+
|col1                                                          |
+--------------------------------------------------------------+
|string                                                        |
+--------------------------------------------------------------+
(1 row)
>>
* select shift (nvarchar('abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz'), int8(256))\g
<<

+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|col1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                                                                                abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijk                                                                                                                                                                                                                                                                                                                               |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)
>>
* select substring(nvarchar('string') from int8(2))\g
<<

+--------------------------------------------------------------+
|col1                                                          |
+--------------------------------------------------------------+
|tring                                                         |
+--------------------------------------------------------------+
(1 row)
>>
* select substring(nvarchar('string') from 2 for int8(4))\g
<<

+--------------------------------------------------------------+
|col1                                                          |
+--------------------------------------------------------------+
|trin                                                          |
+--------------------------------------------------------------+
(1 row)
>>
* \q
<<

>>
.endif
