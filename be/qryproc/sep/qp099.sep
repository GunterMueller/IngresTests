/*
Copyright (c) 2008 Ingres Corporation

	Test Name: qp099.sep (formerly efa33.sep)
	Time: Thu Mar 25 13:43:39 1993
	User Name: testenv
	Terminal type: septerm
 
	Test ID : (TBD)
	Module  : 
	Filename: qp099.sep
	Purpose	: Test passing byref parameters of various datatypes.
	Input Files  :
	Output Files :
	Database     : SEPPARAMDB
	Tables       :
	Synopsis     : Make sure passing byref parameters of various datatypes
		       works.  Test passing compatible and incompatible 
		       datatypes.

 History: 25-Mar-1993	(malee)	Created
           9-Oct-1996	(Author)
		   8-Aug-1997  (merja01) - Changed i4 from long to int.
	  28-Dec-1998	(somsa01)
			Added NT canon for sepcc.
	  25-March-1999  (kamra01) modified VPG_SZ to 2048
	  08-oct-2001	(devjo01) Changed test for maximum char parameter
			size from 2000 & 2001 to 32000 & 32001 to reflect
			lifting of limit in 2.6.   Removed "with pagesize"
			to take advantage of intellegent page size selection
			logic.
          29-Oct-2007	(kiria01) b117790
		Updating canons reflecting string-number coercion changes.
          11-Nov-2007	(kiria01) b119410
		Update canon for test 3.2 which now is compatible.
          10-Oct-2008	(gupsh01)
		Update error message E_US07DE to E_US082C.
          17-Nov-2008   (vande02)
                Removed the efa33.sc test program to a file in qryproc/src
                to enable efa33.sc to be used for a default charset and
                efa33_utf8.sc to be used when SEPPARAM_CHARSET="UTF8".  Added one
                conditional canon for UTF8 for test 2.2.
      27-Feb-2009	(boija02) ING_CHARSET -> SEPPARAM_CHARSET
*/
? fill efa33.sc 
!!
!!
.if SEPPARAM_CHARSET = "UTF8" 
? cp @file(ing_tst,be,qryproc,src,efa33_utf8.sc) efa33.sc 
<<
>>
.else 
? cp @file(ing_tst,be,qryproc,src,efa33.sc) efa33.sc
<<
>>
.endif 
? sepesqlc efa33.sc 
<<
ESQL efa33.sc:
>>
? sepcc efa33.c 
<<
>>
<<
efa33.c
>>
? seplnk efa33 
<<
>>
? sql -s SEPPARAMDB 
<<
~
>>
* drop procedure efa33_1\g
<<
~
>>
* drop procedure efa33_2_1\g
<<
~
>>
* drop table xyz1\g
<<
~
>>
* drop procedure efa33_2_2\g
<<
~
>>
* drop table xyz2\g
<<
~
>>
* drop procedure efa33_3_1\g
<<
~
>>
* drop procedure efa33_3_2\g
<<
~
>>
* drop procedure efa33_3_3\g
<<
~
>>
* drop procedure efa33_3_4\g
<<
~
>>
* drop procedure efa33_3_5\g
<<
~
>>
* drop procedure efa33_4\g
<<
~
>>
* \q
<<
>>
? run efa33.exe SEPPARAMDB 1 
<<

test 1:  passing byref parameter of all datatypes

E_US0965 Procedure 'efa33_1' not found.
    (Tue Apr 27 18:14:27 1993)
passing i1         = 1
passing i2         = 10
passing i4         = 100
passing f4         = 0.100000
passing f8         = 0.010000
passing c10        = a
passing char10     = aa
passing vchar10    = aaa
passing varchar10  = aaaa
passing d          = 01-jan-1993
passing m          = 100.000000
passing deci       = 11.111100
MESSAGE 0: return byref parameter of all datatypes
returned i1        = 2
returned i2        = 20
returned i4        = 200
returned f4        = 0.200000
returned f8        = 0.020000
returned c10       = b
returned char10    = bb
returned vchar10   = bbb
returned varchar10 = bbbb
returned d         = 02-jan-1993
returned m         = 2.450000
returned deci      = 22.222200

>>
? run efa33.exe SEPPARAMDB 2 
<< IF (SEPPARAM_CHARSET == "UTF8") 

test 2.1:  passing byref parameter max data length

E_US0965 Procedure 'efa33_2_1' not found.
    (Mon Nov 17 15:13:23 2008)
E_US0AC1 DROP: 'xyz1' does not exist or is not owned by you.
    (Mon Nov 17 15:13:23 2008)
passing lchar  = This is a test for table xyz1.
MESSAGE 0: This is a test for table xyz1.
MESSAGE 0: This is a test for table xyz1 in the database procedure.
returned lchar = This is a test for table xyz1 in the database procedure.

------------------------------------------------------


test 2.2:  passing byref parameter max+1 data length

E_US0965 Procedure 'efa33_2_2' not found.
    (Mon Nov 17 15:13:23 2008)
E_US0962 Invalid column format 'varchar'.
    (Mon Nov 17 15:13:23 2008)
E_US0AC1 DROP: 'xyz2' does not exist or is not owned by you.
    (Mon Nov 17 15:13:23 2008)
E_US082C CREATE or ALTER TABLE: Invalid Length '16001', has been specified
    for column 'bob' of type 'varchar'. Please provide a length value that
    is within allowable limits for 'varchar' datatype.
    (Mon Nov 17 15:13:23 2008)
E_US0845 Table 'xyz2' does not exist or is not owned by you.
    (Mon Nov 17 15:13:23 2008)
E_US0845 Table 'xyz2' does not exist or is not owned by you.
    (Mon Nov 17 15:13:23 2008)
passing lchar  = This is a test for table xyz1 in the database procedure.
E_US0965 Procedure 'efa33_2_2' not found.
    (Mon Nov 17 15:13:23 2008)
returned lchar = This is a test for table xyz1 in the database procedure.
>>
<<

test 2.1:  passing byref parameter max data length

E_US0965 Procedure 'efa33_2_1' not found.
    (Fri Oct 10 14:40:39 2008)
E_US0AC1 DROP: 'xyz1' does not exist or is not owned by you.
    (Fri Oct 10 14:40:39 2008)
passing lchar  = This is a test for table xyz1.
MESSAGE 0: This is a test for table xyz1.
MESSAGE 0: This is a test for table xyz1 in the database procedure.
returned lchar = This is a test for table xyz1 in the database procedure.

------------------------------------------------------


test 2.2:  passing byref parameter max+1 data length

E_US0965 Procedure 'efa33_2_2' not found.
    (Fri Oct 10 14:40:39 2008)
E_US0962 Invalid column format 'varchar'.
    (Fri Oct 10 14:40:39 2008)
E_US0AC1 DROP: 'xyz2' does not exist or is not owned by you.
    (Fri Oct 10 14:40:39 2008)
E_US082C CREATE or ALTER TABLE: Invalid Length '32001', has been specified
    for column 'bob' of type 'varchar'. Please provide a length value that
    is within allowable limits for 'varchar' datatype.
    (Fri Oct 10 14:40:39 2008)
E_US0845 Table 'xyz2' does not exist or is not owned by you.
    (Fri Oct 10 14:40:39 2008)
E_US0845 Table 'xyz2' does not exist or is not owned by you.
    (Fri Oct 10 14:40:39 2008)
passing lchar  = This is a test for table xyz1 in the database procedure.
E_US0965 Procedure 'efa33_2_2' not found.
    (Fri Oct 10 14:40:39 2008)
returned lchar = This is a test for table xyz1 in the database procedure.
>>
? run efa33.exe SEPPARAMDB 3 
<<

test 3.1:  passing byref parameter of various datatypes to integer type

E_US0965 Procedure 'efa33_3_1' not found.
    (Sun Nov 11 19:31:17 2007)
passing integer = 2
returned        = 5
passing integer = 20
returned        = 5
passing integer = 127
returned        = 5
passing integer = 200
E_US1068 Integer overflow detected in query.
    (Sun Nov 11 19:31:17 2007)
returned        = 200
passing float   = 1.100000
returned        = 5.000000
passing float   = 1.010000
returned        = 5.000000
passing char    = a
E_QE0113 Error converting value for the database procedure parameter 'i1'.
    The formal and actual parameter types referenced by an EXECUTE PROCEDURE
    statement or database rule invocation are not compatible.
    (Sun Nov 11 19:31:17 2007)
returned        = a
passing char    = aa
E_QE0113 Error converting value for the database procedure parameter 'i1'.
    The formal and actual parameter types referenced by an EXECUTE PROCEDURE
    statement or database rule invocation are not compatible.
    (Sun Nov 11 19:31:17 2007)
returned        = aa

------------------------------------------------------


test 3.2:  passing byref parameter of various datatypes to character type

E_US0965 Procedure 'efa33_3_2' not found.
    (Sun Nov 11 19:31:17 2007)
passing char    = a
returned        = z
passing too many char = aa
returned              = z
passing integer = 2
returned        = 2
passing float   = 1.100000
returned        = 1.100000

------------------------------------------------------


test 3.3:  passing byref parameter of various datatypes to float type

E_US0965 Procedure 'efa33_3_3' not found.
    (Sun Nov 11 19:31:17 2007)
passing float   = 1.100000
returned        = 4.200000
passing float   = 1.010000
returned        = 4.200000
passing char    = a
E_QE0113 Error converting value for the database procedure parameter 'f4'.
    The formal and actual parameter types referenced by an EXECUTE PROCEDURE
    statement or database rule invocation are not compatible.
    (Sun Nov 11 19:31:17 2007)
returned        = a
passing integer = 2
returned        = 4
passing integer = 200
returned        = 4

------------------------------------------------------


test 3.4:  passing byref parameter of various datatypes length

E_US0965 Procedure 'efa33_3_4' not found.
    (Sun Nov 11 19:31:17 2007)
passing f4 -> f8 = 1.100000 9.900000, i2 -> i4 = 20, i4 -> i2 = 200
returned         = 2.020000 0.020000,            500,            50

------------------------------------------------------


test 3.5:  passing byref parameter of various datatypes to decimal type

E_US0965 Procedure 'efa33_3_5' not found.
    (Sun Nov 11 19:31:17 2007)
passing float   = 1.100
MESSAGE 0: 1.100
MESSAGE 0: 50.789
returned        = 50.789
passing float   = 0.600
MESSAGE 0: 0.600
MESSAGE 0: 50.789
returned        = 50.789
passing float   = 1.010000
MESSAGE 0: 1.010
MESSAGE 0: 50.789
returned        = 50.789000
passing char    = a
E_QE0113 Error converting value for the database procedure parameter
    'deci'. The formal and actual parameter types referenced by an EXECUTE
    PROCEDURE statement or database rule invocation are not compatible.
    (Sun Nov 11 19:31:17 2007)
returned        = a
passing integer = 2
MESSAGE 0: 2.000
MESSAGE 0: 50.789
returned        = 50
passing integer = 200
E_AD1127 Packed Decimal overflow detected in query.
    (Sun Nov 11 19:31:17 2007)
returned        = 200
>>
? run efa33.exe SEPPARAMDB 4 
<<

test 4.1:  passing byref parameter from values to nullable datatypes

E_US0965 Procedure 'efa33_4' not found.
    (Tue Apr 27 18:14:31 1993)
passing i       = 100
passing f4      = 20843.324
passing c10     = howdy!
returned i      = 0
returned f4     = 0.000
returned c10    = 

------------------------------------------------------


test 4.2:  passing byref parameter nullable to nullable datatypes

passing i       = 0
passing f4      = 0.000000
passing c10     = 
returned i      = 0
returned f4     = 0.000000
returned c10    = 
>>
? delete efa33.c 
<<
~
>>
? delete efa33.o 
<<
~
>>
? delete efa33.obj 
<<
~
>>
? delete efa33.exe 
<<
~
>>


Ending at: Mon Nov 17 15:14:05 2008
