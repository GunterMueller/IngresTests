/*
Copyright (c) 2004 Ingres Corporation


	Test Name: qp039
	Time:  9-OCT-1989 16:39:23
	User Name: testenv     
 
	Test ID :	qp039
	Module  : 	qryproc
	Filename:	qp039.sep
	Purpose	:	Test subqueries using simple AGGREGATES with link back
			on NULL.
	Input Files  :	None
	Output Files :	None
	Database     :	SEPPARAMDB
	Tables       :	eca18_sp and eca18_spj
	Spnopsis     :	

	History	: 09-Oct-1989	Created
          07-Jan-1999   (hanch04) update row orders.
	  23-Mar-1999   (vande02) Hard-coded VPG_SZ to 4K and changed
				'sql -s SEPPARAMDB' canon to be empty,
                                in order to catch the msg. "TM could not connect
                                ..." if the test database did not exist.
          02-May-2003   (sinna02) Added order by and recanonised order diff.
          29-Nov-2004   (legru01) Added "order by" clauses to the select * 
                                                    statements to control how returned results
                                                    are displayed.
          30-Jan-2006	(boija02) Updated copyright info for Ingres Corp.

*/
? fill eca18spnull.dat 
!!
1	1	   300	
1	2	   200	
1	3	   400	
1	4	   200	
1	5	   100	
1	6	   100	
2	1	   300	
2	2	   400	
3	2	   200	
4	2	   200	
4	4	   300	
4	5	   400	
!!
? fill eca18spjnull.dat 
!!
1	1	1	   200	
1	1	4	   700	
2	3	1	   400	
2	3	2	   200	
2	3	3	   200	
2	3	4	   500	
2	3	5	   600	
2	3	6	   400	
2	3	7	   800	
2	5	2	   100	
3	3	1	   200	
3	4	2	   500	
4	6	3	   300	
4	6	7	   300	
5	2	2	   200	
5	2	4	   100	
5	5	5	   500	
5	5	7	   100	
5	6	2	   200	
5	1	4	   100	
5	3	4	   200	
5	4	4	   800	
5	5	4	   400	
5	6	4	   500	
!!
? fill eca18spnullbig.dat 
!!
            1	            1	          300	
            1	            2	          200	
            1	            3	          400	
            1	            4	          200	
            1	            5	          100	
            1	            6	          100	
            2	            1	          300	
            2	            2	          400	
            3	            2	          200	
            4	            2	          200	
            4	            4	          300	
            4	            5	          400	
           13	           13	          312	
           13	           14	          212	
           13	           15	          412	
           13	           16	          212	
           13	           17	          112	
           13	           18	          112	
           14	           13	          312	
           14	           14	          412	
           15	           14	          212	
           16	           14	          212	
           16	           16	          312	
           16	           17	          412	
           25	           25	          324	
           25	           26	          224	
           25	           27	          424	
           25	           28	          224	
           25	           29	          124	
           25	           30	          124	
           26	           25	          324	
           26	           26	          424	
           27	           26	          224	
           28	           26	          224	
           28	           28	          324	
           28	           29	          424	
           37	           37	          336	
           37	           38	          236	
           37	           39	          436	
           37	           40	          236	
           37	           41	          136	
           37	           42	          136	
           38	           37	          336	
           38	           38	          436	
           39	           38	          236	
           40	           38	          236	
           40	           40	          336	
           40	           41	          436	
            1	            1	          300	
            1	            2	          200	
            1	            3	          400	
            1	            4	          200	
            1	            5	          100	
            1	            6	          100	
            2	            1	          300	
            2	            2	          400	
            3	            2	          200	
            4	            2	          200	
            4	            4	          300	
            4	            5	          400	
           13	           13	          312	
           13	           14	          212	
           13	           15	          412	
           13	           16	          212	
           13	           17	          112	
           13	           18	          112	
           14	           13	          312	
           14	           14	          412	
           15	           14	          212	
           16	           14	          212	
           16	           16	          312	
           16	           17	          412	
           25	           25	          324	
           25	           26	          224	
           25	           27	          424	
           25	           28	          224	
           25	           29	          124	
           25	           30	          124	
           26	           25	          324	
           26	           26	          424	
           27	           26	          224	
           28	           26	          224	
           28	           28	          324	
           28	           29	          424	
           37	           37	          336	
           37	           38	          236	
           37	           39	          436	
           37	           40	          236	
           37	           41	          136	
           37	           42	          136	
           38	           37	          336	
           38	           38	          436	
           39	           38	          236	
           40	           38	          236	
           40	           40	          336	
           40	           41	          436	
!!
? fill eca18spjnullbig.dat 
!!
            1	            1	            1	          200	
            1	            1	            4	          700	
            2	            3	            1	          400	
            2	            3	            2	          200	
            2	            3	            3	          200	
            2	            3	            4	          500	
            2	            3	            5	          600	
            2	            3	            6	          400	
            2	            3	            7	          800	
            2	            5	            2	          100	
            3	            3	            1	          200	
            3	            4	            2	          500	
            4	            6	            3	          300	
            4	            6	            7	          300	
            5	            2	            2	          200	
            5	            2	            4	          100	
            5	            5	            5	          500	
            5	            5	            7	          100	
            5	            6	            2	          200	
            5	            1	            4	          100	
            5	            3	            4	          200	
            5	            4	            4	          800	
            5	            5	            4	          400	
            5	            6	            4	          500	
           25	           25	           25	          224	
           25	           25	           28	          724	
           26	           27	           25	          424	
           26	           27	           26	          224	
           26	           27	           27	          224	
           26	           27	           28	          524	
           26	           27	           29	          624	
           26	           27	           30	          424	
           26	           27	           31	          824	
           26	           29	           26	          124	
           27	           27	           25	          224	
           27	           28	           26	          524	
           28	           30	           27	          324	
           28	           30	           31	          324	
           29	           26	           26	          224	
           29	           26	           28	          124	
           29	           29	           29	          524	
           29	           29	           31	          124	
           29	           30	           26	          224	
           29	           25	           28	          124	
           29	           27	           28	          224	
           29	           28	           28	          824	
           29	           29	           28	          424	
           29	           30	           28	          524	
            1	            1	            1	          200	
            1	            1	            4	          700	
            2	            3	            1	          400	
            2	            3	            2	          200	
            2	            3	            3	          200	
            2	            3	            4	          500	
            2	            3	            5	          600	
            2	            3	            6	          400	
            2	            3	            7	          800	
            2	            5	            2	          100	
            3	            3	            1	          200	
            3	            4	            2	          500	
            4	            6	            3	          300	
            4	            6	            7	          300	
            5	            2	            2	          200	
            5	            2	            4	          100	
            5	            5	            5	          500	
            5	            5	            7	          100	
            5	            6	            2	          200	
            5	            1	            4	          100	
            5	            3	            4	          200	
            5	            4	            4	          800	
            5	            5	            4	          400	
            5	            6	            4	          500	
           25	           25	           25	          224	
           25	           25	           28	          724	
           26	           27	           25	          424	
           26	           27	           26	          224	
           26	           27	           27	          224	
           26	           27	           28	          524	
           26	           27	           29	          624	
           26	           27	           30	          424	
           26	           27	           31	          824	
           26	           29	           26	          124	
           27	           27	           25	          224	
           27	           28	           26	          524	
           28	           30	           27	          324	
           28	           30	           31	          324	
           29	           26	           26	          224	
           29	           26	           28	          124	
           29	           29	           29	          524	
           29	           29	           31	          124	
           29	           30	           26	          224	
           29	           25	           28	          124	
           29	           27	           28	          224	
           29	           28	           28	          824	
           29	           29	           28	          424	
           29	           30	           28	          524	
!!
? sql -s SEPPARAMDB 
<<

>>
* drop table eca18_sp;\g 
<<
E_US0AC1 DROP: 'eca18_sp' does not exist or is not owned by you.
    (10-OCT-1989 10:21:11)

>>
<<
>>
* create table eca18_sp (
<<
>>
* 	sno integer not null, pno integer not null, 
<<
>>
* 	qty integer not null, extra integer with null)
<<
>>
* 	with duplicates, page_size=4096;\g 
<<
>>
* copy table eca18_sp (
<<
>>
* 	sno =c0tab, pno =c0tab, qty =c0tab, extra =c0nl)
<<
>>
* 	from 'eca18spnull.dat';\g 
<<
(12 rows)
>>
* drop table eca18_spj;\g 
<<
E_US0AC1 DROP: 'eca18_spj' does not exist or is not owned by you.
    (10-OCT-1989 10:24:11)

>>
<<
>>
* create table eca18_spj (
<<
>>
* 	sno integer not null, pno integer not null, 
<<
>>
* 	jno integer not null, qty integer not null, 
<<
>>
* 	extra integer with null ) 
<<
>>
* 	with noduplicates, page_size=4096;\g 
<<
>>
* copy table eca18_spj (
<<
>>
* 	sno =c0tab, pno =c0tab, jno =c0tab, qty =c0tab, extra =c0nl)
<<
>>
*	from 'eca18spjnull.dat';\g 
<<
(24 rows)
>>
* select * from eca18_sp order by sno, pno, qty;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            2|          200|             |
|            1|            3|          400|             |
|            1|            4|          200|             |
|            1|            5|          100|             |
|            1|            6|          100|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
|            3|            2|          200|             |
|            4|            2|          200|             |
|            4|            4|          300|             |
|            4|            5|          400|             |
+-------------+-------------+-------------+-------------+
(12 rows)
>>
* select * from eca18_spj order by sno, pno, jno, qty;\g 
<<

+-------------+-------------+-------------+-------------+-------------+
|sno          |pno          |jno          |qty          |extra        |
+-------------+-------------+-------------+-------------+-------------+
|            1|            1|            1|          200|             |
|            1|            1|            4|          700|             |
|            2|            3|            1|          400|             |
|            2|            3|            2|          200|             |
|            2|            3|            3|          200|             |
|            2|            3|            4|          500|             |
|            2|            3|            5|          600|             |
|            2|            3|            6|          400|             |
|            2|            3|            7|          800|             |
|            2|            5|            2|          100|             |
|            3|            3|            1|          200|             |
|            3|            4|            2|          500|             |
|            4|            6|            3|          300|             |
|            4|            6|            7|          300|             |
|            5|            1|            4|          100|             |
|            5|            2|            2|          200|             |
|            5|            2|            4|          100|             |
|            5|            3|            4|          200|             |
|            5|            4|            4|          800|             |
|            5|            5|            4|          400|             |
|            5|            5|            5|          500|             |
|            5|            5|            7|          100|             |
|            5|            6|            2|          200|             |
|            5|            6|            4|          500|             |
+-------------+-------------+-------------+-------------+-------------+
(24 rows)
>>
* create view eca18_sp_v as select * from eca18_sp;\g 
<<
>>
* create view eca18_spj_v as select * from eca18_spj;\g 
<<
>>
* select * from eca18_sp_v order by sno, pno, qty;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            2|          200|             |
|            1|            3|          400|             |
|            1|            4|          200|             |
|            1|            5|          100|             |
|            1|            6|          100|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
|            3|            2|          200|             |
|            4|            2|          200|             |
|            4|            4|          300|             |
|            4|            5|          400|             |
+-------------+-------------+-------------+-------------+
(12 rows)
>>
* select * from eca18_spj_v order by sno, pno, jno, qty;\g 
<<

+-------------+-------------+-------------+-------------+-------------+
|sno          |pno          |jno          |qty          |extra        |
+-------------+-------------+-------------+-------------+-------------+
|            1|            1|            1|          200|             |
|            1|            1|            4|          700|             |
|            2|            3|            1|          400|             |
|            2|            3|            2|          200|             |
|            2|            3|            3|          200|             |
|            2|            3|            4|          500|             |
|            2|            3|            5|          600|             |
|            2|            3|            6|          400|             |
|            2|            3|            7|          800|             |
|            2|            5|            2|          100|             |
|            3|            3|            1|          200|             |
|            3|            4|            2|          500|             |
|            4|            6|            3|          300|             |
|            4|            6|            7|          300|             |
|            5|            1|            4|          100|             |
|            5|            2|            2|          200|             |
|            5|            2|            4|          100|             |
|            5|            3|            4|          200|             |
|            5|            4|            4|          800|             |
|            5|            5|            4|          400|             |
|            5|            5|            5|          500|             |
|            5|            5|            7|          100|             |
|            5|            6|            2|          200|             |
|            5|            6|            4|          500|             |
+-------------+-------------+-------------+-------------+-------------+
(24 rows)
>>
* select * from eca18_sp 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj 
<<
>>
*	where eca18_spj.sno = eca18_sp.sno and eca18_sp.extra is NULL) -
order by 1,2;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
|            4|            5|          400|             |
+-------------+-------------+-------------+-------------+
(5 rows)
>>
* select * from eca18_sp 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj 
<<
>>
*	where eca18_spj.sno = eca18_sp.sno 
<<
>>
*		and eca18_spj.jno < 3 and eca18_sp.extra is NULL) -
order by 1,2;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
+-------------+-------------+-------------+-------------+
(4 rows)
>>
* select * from eca18_sp_v 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj_v 
<<
>>
*	where eca18_spj_v.sno = eca18_sp_v.sno 
<<
>>
*		and eca18_sp_v.extra is NULL) -
order by 1,2;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
|            4|            5|          400|             |
+-------------+-------------+-------------+-------------+
(5 rows)
>>
* select * from eca18_sp_v 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj_v 
<<
>>
*	where eca18_spj_v.sno = eca18_sp_v.sno 
<<
>>
*		and eca18_spj_v.jno < 3 
<<
>>
*		and eca18_sp_v.extra is NULL) order by 1, 2;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
+-------------+-------------+-------------+-------------+
(4 rows)
>>
* set trace point op132;\g 
<<
>>
* select * from eca18_sp 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj 
<<
>>
*	where eca18_spj.sno = eca18_sp.sno 
<<
>>
*		and eca18_sp.extra is NULL) order by sno, pno;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
|            4|            5|          400|             |
+-------------+-------------+-------------+-------------+
(5 rows)
>>
* select * from eca18_sp 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj 
<<
>>
*	where eca18_spj.sno = eca18_sp.sno 
<<
>>
*		and eca18_spj.jno < 3 
<<
>>
*		and eca18_sp.extra is NULL) order by sno, pno;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
+-------------+-------------+-------------+-------------+
(4 rows)
>>
* select * from eca18_sp_v 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj_v 
<<
>>
*	where eca18_spj_v.sno = eca18_sp_v.sno 
<<
>>
*		and eca18_sp_v.extra is NULL) order by sno, pno;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
|            4|            5|          400|             |
+-------------+-------------+-------------+-------------+
(5 rows)
>>
* select * from eca18_sp_v 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj_v 
<<
>>
*	where eca18_spj_v.sno = eca18_sp_v.sno 
<<
>>
*		and eca18_spj_v.jno < 3 
<<
>>
*		and eca18_sp_v.extra is NULL) order by sno, pno;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
+-------------+-------------+-------------+-------------+
(4 rows)
>>
* drop table eca18_sp;\g 
<<
>>
* create table eca18_sp (
<<
>>
* 	sno integer not null, pno integer not null, 
<<
>>
*	qty integer not null, extra integer with null ) 
<<
>>
* 	with duplicates, page_size=4096;\g 
<<
>>
* copy table eca18_sp (
<<
>>
* 	sno =c0tab, pno =c0tab, qty =c0tab, extra =c0nl ) 
<<
>>
*	from 'eca18spnullbig.dat';\g 
<<
(96 rows)
>>
* drop table eca18_spj;\g 
<<
>>
* create table eca18_spj (
<<
>>
* 	sno integer not null, pno integer not null, 
<<
>>
* 	jno integer not null, qty integer not null, 
<<
>>
*	extra integer with null ) 
<<
>>
* 	with noduplicates, page_size=4096;\g 
<<
>>
* copy table eca18_spj (
<<
>>
* 	sno =c0tab, pno =c0tab, jno =c0tab, qty =c0tab, extra =c0nl ) 
<<
>>
*	from 'eca18spjnullbig.dat';\g 
<<
(96 rows)
>>
* select distinct * from eca18_sp order by sno, pno, qty;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            2|          200|             |
|            1|            3|          400|             |
|            1|            4|          200|             |
|            1|            5|          100|             |
|            1|            6|          100|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
|            3|            2|          200|             |
|            4|            2|          200|             |
|            4|            4|          300|             |
|            4|            5|          400|             |
|           13|           13|          312|             |
|           13|           14|          212|             |
|           13|           15|          412|             |
|           13|           16|          212|             |
|           13|           17|          112|             |
|           13|           18|          112|             |
|           14|           13|          312|             |
|           14|           14|          412|             |
|           15|           14|          212|             |
|           16|           14|          212|             |
|           16|           16|          312|             |
|           16|           17|          412|             |
|           25|           25|          324|             |
|           25|           26|          224|             |
|           25|           27|          424|             |
|           25|           28|          224|             |
|           25|           29|          124|             |
|           25|           30|          124|             |
|           26|           25|          324|             |
|           26|           26|          424|             |
|           27|           26|          224|             |
|           28|           26|          224|             |
|           28|           28|          324|             |
|           28|           29|          424|             |
|           37|           37|          336|             |
|           37|           38|          236|             |
|           37|           39|          436|             |
|           37|           40|          236|             |
|           37|           41|          136|             |
|           37|           42|          136|             |
|           38|           37|          336|             |
|           38|           38|          436|             |
|           39|           38|          236|             |
|           40|           38|          236|             |
|           40|           40|          336|             |
|           40|           41|          436|             |
+-------------+-------------+-------------+-------------+
(48 rows)
>>
* select distinct * from eca18_spj order by sno, pno, jno, qty;\g 
<<


+-------------+-------------+-------------+-------------+-------------+
|sno          |pno          |jno          |qty          |extra        |
+-------------+-------------+-------------+-------------+-------------+
|            1|            1|            1|          200|             |
|            1|            1|            4|          700|             |
|            2|            3|            1|          400|             |
|            2|            3|            2|          200|             |
|            2|            3|            3|          200|             |
|            2|            3|            4|          500|             |
|            2|            3|            5|          600|             |
|            2|            3|            6|          400|             |
|            2|            3|            7|          800|             |
|            2|            5|            2|          100|             |
|            3|            3|            1|          200|             |
|            3|            4|            2|          500|             |
|            4|            6|            3|          300|             |
|            4|            6|            7|          300|             |
|            5|            1|            4|          100|             |
|            5|            2|            2|          200|             |
|            5|            2|            4|          100|             |
|            5|            3|            4|          200|             |
|            5|            4|            4|          800|             |
|            5|            5|            4|          400|             |
|            5|            5|            5|          500|             |
|            5|            5|            7|          100|             |
|            5|            6|            2|          200|             |
|            5|            6|            4|          500|             |
|           25|           25|           25|          224|             |
|           25|           25|           28|          724|             |
|           26|           27|           25|          424|             |
|           26|           27|           26|          224|             |
|           26|           27|           27|          224|             |
|           26|           27|           28|          524|             |
|           26|           27|           29|          624|             |
|           26|           27|           30|          424|             |
|           26|           27|           31|          824|             |
|           26|           29|           26|          124|             |
|           27|           27|           25|          224|             |
|           27|           28|           26|          524|             |
|           28|           30|           27|          324|             |
|           28|           30|           31|          324|             |
|           29|           25|           28|          124|             |
|           29|           26|           26|          224|             |
|           29|           26|           28|          124|             |
|           29|           27|           28|          224|             |
|           29|           28|           28|          824|             |
|           29|           29|           28|          424|             |
|           29|           29|           29|          524|             |
|           29|           29|           31|          124|             |
|           29|           30|           26|          224|             |
|           29|           30|           28|          524|             |
+-------------+-------------+-------------+-------------+-------------+
(48 rows)
>>
* create view eca18_sp_v as 
<<
>>
*	select * from eca18_sp eca18_sp1 
<<
>>
*	where sno = 
<<
>>
*	 (select distinct sno from eca18_sp eca18_sp2 
<<
>>
*	where eca18_sp1.sno = eca18_sp2.sno 
<<
>>
* 		and eca18_sp1.pno = eca18_sp2.pno 
<<
>>
* 		and eca18_sp2.pno < 10 
<<
>>
* 		and eca18_sp2.qty < 250) 
<<
>>
* union 
<<
>>
* select * from eca18_sp eca18_sp1 
<<
>>
*	where sno = 
<<
>>
*	 (select distinct sno from eca18_sp eca18_sp2 
<<
>>
*	where eca18_sp1.sno = eca18_sp2.sno 
<<
>>
* 		and eca18_sp1.pno = eca18_sp2.pno 
<<
>>
* 		and eca18_sp2.pno < 10 
<<
>>
* 		and eca18_sp2.qty > 250) 
<<
>>
* union 
<<
>>
* select * from eca18_sp eca18_sp1 
<<
>>
*	where sno = 
<<
>>
*	 (select distinct sno from eca18_sp eca18_sp2 
<<
>>
*	where eca18_sp1.sno = eca18_sp2.sno 
<<
>>
* 		and eca18_sp1.pno = eca18_sp2.pno 
<<
>>
* 		and eca18_sp2.pno < 10 
<<
>>
* 		and eca18_sp2.qty > 350);\g
<<
>>
* create view eca18_spj_v as 
<<
>>
* select distinct sno, pno, jno, qty from eca18_spj 
<<
>>
*	where sno between 1 and 3 
<<
>>
* 		or pno < 10 
<<
>>
* 		or ((jno = pno) and (jno < 10)) 
<<
>>
* 		or qty in (100, 200, 300, 400, 500, 600, 700);\g 
<<
>>
* select * from eca18_sp_v order by sno, pno, qty;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            2|          200|             |
|            1|            3|          400|             |
|            1|            4|          200|             |
|            1|            5|          100|             |
|            1|            6|          100|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
|            3|            2|          200|             |
|            4|            2|          200|             |
|            4|            4|          300|             |
|            4|            5|          400|             |
+-------------+-------------+-------------+-------------+
(12 rows)
>>
* select * from eca18_spj_v order by sno, pno, jno, qty;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |jno          |qty          |
+-------------+-------------+-------------+-------------+
|            1|            1|            1|          200|
|            1|            1|            4|          700|
|            2|            3|            1|          400|
|            2|            3|            2|          200|
|            2|            3|            3|          200|
|            2|            3|            4|          500|
|            2|            3|            5|          600|
|            2|            3|            6|          400|
|            2|            3|            7|          800|



|            2|            5|            2|          100|
|            3|            3|            1|          200|
|            3|            4|            2|          500|
|            4|            6|            3|          300|
|            4|            6|            7|          300|
|            5|            1|            4|          100|
|            5|            2|            2|          200|
|            5|            2|            4|          100|
|            5|            3|            4|          200|
|            5|            4|            4|          800|
|            5|            5|            4|          400|
|            5|            5|            5|          500|
|            5|            5|            7|          100|
|            5|            6|            2|          200|
|            5|            6|            4|          500|
+-------------+-------------+-------------+-------------+
(24 rows)
>>
* select * from eca18_sp_v 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj_v 
<<
>>
*	where eca18_spj_v.sno = eca18_sp_v.sno 
<<
>>
*		and eca18_sp_v.extra is NULL) order by 1,2;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
|            4|            5|          400|             |
+-------------+-------------+-------------+-------------+
(5 rows)
>>
* select * from eca18_sp_v 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj_v 
<<
>>
*	where eca18_spj_v.sno = eca18_sp_v.sno 
<<
>>
*		and eca18_spj_v.jno < 3 
<<
>>
*		and eca18_sp_v.extra is NULL) order by 1, 2;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
+-------------+-------------+-------------+-------------+
(4 rows)
>>
* set notrace point op132;\g 
<<
>>
* select * from eca18_sp_v 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj_v 
<<
>>
*	where eca18_spj_v.sno = eca18_sp_v.sno 
<<
>>
*		and eca18_sp_v.extra is NULL) order by 1,2;\g 
/*
*/
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
|            4|            5|          400|             |
+-------------+-------------+-------------+-------------+
(5 rows)
>>
* select * from eca18_sp_v 
<<
>>
*	where qty > 
<<
>>
*	 (select min(qty) from eca18_spj_v 
<<
>>
*	where eca18_spj_v.sno = eca18_sp_v.sno 
<<
>>
*		and eca18_spj_v.jno < 3 
<<
>>
*		and eca18_sp_v.extra is NULL) order by 1, 2;\g 
<<

+-------------+-------------+-------------+-------------+
|sno          |pno          |qty          |extra        |
+-------------+-------------+-------------+-------------+
|            1|            1|          300|             |
|            1|            3|          400|             |
|            2|            1|          300|             |
|            2|            2|          400|             |
+-------------+-------------+-------------+-------------+
(4 rows)
>>
* drop table eca18_sp, eca18_spj;\g
<<
>>
* \q 
<<
>>


Ending at: 19-APR-1991 11:40:10
